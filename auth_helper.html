<!DOCTYPE html>
<html>
<head>
    <title>Send From Duck | Auth Helper</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./styles/auth_help_style.css">
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</head>
<body>
    <div id="errorDiv" class="error" style="display: none;">No API key given!</div>
    <div id="popup" class="popup" style="display: none;">
        <h2>Your special login URL</h2>
        <h3 style="text-align: center;">
            <a id="link" href="">Find out how this works</a>
        </h3>
        <input id="input" type="text" readOnly>
        <button id="button">Copy to clipboard</button>
    </div>

    <footer style="display: flex; justify-content: center; align-items: center; width: 100%; position: fixed; bottom: 0;">
        <div id="google_translate_element"></div>
      </footer>
      <script>
        function googleTranslateElementInit() {
          new google.translate.TranslateElement(
            { pageLanguage: "en" },
            "google_translate_element"
          );
        }
      </script>

    <script>
        window.onload = function() {
            // Check if the user has dark mode enabled
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                // Add the dark-mode class to the body element
                const elements = document.querySelectorAll("*");
                elements.forEach(function(element) {
                    element.classList.toggle("dark-mode");
                });
            }        
            // Get the value of the key parameter from the URL
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('key');
            // If the code parameter is present, show a popup with its value
            if (!code) {
                document.getElementById('errorDiv').style.display = 'block';
            } else {
                document.getElementById('popup').style.display = 'block';
                document.getElementById('link').href = 'https://github.com/Hamster45105/DuckAddressSend/wiki/Functions#special-login-url';
                document.getElementById('input').value = 'https://hamster45105.github.io/DuckAddressSend/auth?key=' + code;
                document.getElementById('button').addEventListener('click', function() {
                    document.getElementById('input').select();
                    document.execCommand('copy');
                    this.textContent = 'Copied!';
                    this.style.backgroundColor = '#008000';
                });
            }
        }
    </script>
</body>
</html>